(function(){"use strict";var e={3740:function(e,t,i){var o=i(5130),r=i(6768);const a={id:"app"};function s(e,t,i,o,s,l){const n=(0,r.g2)("router-link"),c=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.Lk)("header",null,[t[3]||(t[3]=(0,r.Lk)("h1",null,"Каталогизатор комиксов",-1)),(0,r.Lk)("nav",null,[(0,r.bF)(n,{to:"/"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.eW)("Список комиксов")]))),_:1,__:[0]}),t[2]||(t[2]=(0,r.eW)(" | ")),(0,r.bF)(n,{to:"/add"},{default:(0,r.k6)((()=>t[1]||(t[1]=[(0,r.eW)("Добавить комикс")]))),_:1,__:[1]})])]),(0,r.Lk)("main",null,[(0,r.bF)(c)]),t[4]||(t[4]=(0,r.Lk)("footer",null,[(0,r.Lk)("p",null,"© 2023 Мой Каталогизатор")],-1))])}var l={name:"App",mounted(){window.addEventListener("load",(()=>{console.log("Вся страница загружена (включая изображения)"),this.yourCustomFunction()}))},methods:{yourCustomFunction(){const e=document.querySelector(".preloader"),t=document.querySelector("#app");e&&t&&(e.style.opacity="0",e.style.visibility="hidden",t.style.display="block",e.remove()),console.log("Выполняется пользовательская функция после полной загрузки")}}},n=i(1241);const c=(0,n.A)(l,[["render",s]]);var u=c,m=i(1387),d=i(4232);const h={class:"comic-list"},p={class:"search"},g={class:"search__input-search"},f={key:0,style:{color:"green","margin-left":"10px"}},k={class:"search__list"},b={class:"filters"},v={key:0},y={key:0},L={key:1},C={key:2},_={key:3},E={key:4},w={key:5},I={key:6},A={class:"filter-block"},P={class:"filter"},S=["value"],F={class:"filter"},X=["value"],x={class:"filter"},T=["value"],D={class:"filter"},O=["value"],U={class:"sort"},V=["innerHTML"],M=["innerHTML"],Q={class:"comics-block"},R={class:"pagination"},j=["disabled"],J=["max"],Y=["disabled"];function $(e,t,i,a,s,l){const n=(0,r.g2)("RandomComics"),c=(0,r.g2)("comic-card");return(0,r.uX)(),(0,r.CE)("div",h,[(0,r.bF)(n,{comics:s.comics},null,8,["comics"]),(0,r.Lk)("h2",null," Список комиксов ("+(0,d.v_)(s.comics.length)+") ",1),(0,r.Lk)("div",p,[t[19]||(t[19]=(0,r.Lk)("h3",{class:"search__title"},"Поиск",-1)),(0,r.Lk)("div",g,[(0,r.bo)((0,r.Lk)("input",{class:(0,d.C4)(["search__field-search",{"search-applied":s.isSearchApplied}]),type:"search","onUpdate:modelValue":t[0]||(t[0]=e=>s.searchQuery=e),placeholder:"Введите текст для поиска"},null,2),[[o.Jo,s.searchQuery]]),(0,r.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>l.applySearch&&l.applySearch(...e)),class:"button button--accent"},"Поиск")]),s.isSearchApplied?((0,r.uX)(),(0,r.CE)("span",f,"✔ Поиск применён")):(0,r.Q3)("",!0),(0,r.Lk)("div",k,[(0,r.bo)((0,r.Lk)("input",{class:"search__field",type:"radio","onUpdate:modelValue":t[2]||(t[2]=e=>s.searchField=e),value:"title",id:"title"},null,512),[[o.XL,s.searchField]]),t[16]||(t[16]=(0,r.Lk)("label",{class:"search__label",for:"title"},"Заголовок (ENG)",-1)),(0,r.bo)((0,r.Lk)("input",{class:"search__field",type:"radio","onUpdate:modelValue":t[3]||(t[3]=e=>s.searchField=e),value:"title_ru",id:"title-ru"},null,512),[[o.XL,s.searchField]]),t[17]||(t[17]=(0,r.Lk)("label",{class:"search__label",for:"title-ru"},"Заголовок (RU)",-1)),(0,r.bo)((0,r.Lk)("input",{class:"search__field",type:"radio","onUpdate:modelValue":t[4]||(t[4]=e=>s.searchField=e),value:"summary",id:"summary"},null,512),[[o.XL,s.searchField]]),t[18]||(t[18]=(0,r.Lk)("label",{class:"search__label",for:"summary"},"Описание",-1))])]),t[33]||(t[33]=(0,r.Lk)("hr",null,null,-1)),(0,r.Lk)("div",b,[t[29]||(t[29]=(0,r.Lk)("h3",null,"Фильтр:",-1)),s.selectedPublisher||s.selectedCharacter||s.selectedYear||s.selectedArtist?((0,r.uX)(),(0,r.CE)("p",v,[t[20]||(t[20]=(0,r.eW)(" Фильтр: ")),s.selectedPublisher?((0,r.uX)(),(0,r.CE)("span",y,"Издательство "+(0,d.v_)(s.selectedPublisher),1)):(0,r.Q3)("",!0),s.selectedPublisher&&(s.selectedCharacter||s.selectedYear||s.selectedArtist)?((0,r.uX)(),(0,r.CE)("span",L,", ")):(0,r.Q3)("",!0),s.selectedCharacter?((0,r.uX)(),(0,r.CE)("span",C,"Персонаж "+(0,d.v_)(s.selectedCharacter),1)):(0,r.Q3)("",!0),s.selectedCharacter&&(s.selectedYear||s.selectedArtist)?((0,r.uX)(),(0,r.CE)("span",_,", ")):(0,r.Q3)("",!0),s.selectedYear?((0,r.uX)(),(0,r.CE)("span",E,"Год "+(0,d.v_)(s.selectedYear),1)):(0,r.Q3)("",!0),s.selectedYear&&s.selectedArtist?((0,r.uX)(),(0,r.CE)("span",w,", ")):(0,r.Q3)("",!0),s.selectedArtist?((0,r.uX)(),(0,r.CE)("span",I,"Художник "+(0,d.v_)(s.selectedArtist),1)):(0,r.Q3)("",!0),(0,r.eW)(" ("+(0,d.v_)(l.filteredComics.length)+") ",1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",A,[(0,r.Lk)("div",P,[t[22]||(t[22]=(0,r.Lk)("label",{for:"publisher"},"Издательство:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"publisher","onUpdate:modelValue":t[5]||(t[5]=e=>s.selectedPublisher=e)},[t[21]||(t[21]=(0,r.Lk)("option",{value:""},"Все",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.publishers,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.name,value:e.name},(0,d.v_)(e.name)+" ("+(0,d.v_)(e.count)+") ",9,S)))),128))],512),[[o.u1,s.selectedPublisher]])]),(0,r.Lk)("div",F,[t[24]||(t[24]=(0,r.Lk)("label",{for:"artist"},"Художник:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"artist","onUpdate:modelValue":t[6]||(t[6]=e=>s.selectedArtist=e)},[t[23]||(t[23]=(0,r.Lk)("option",{value:""},"Все",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.artists,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.name,value:e.name},(0,d.v_)(e.name)+" ("+(0,d.v_)(e.count)+") ",9,X)))),128))],512),[[o.u1,s.selectedArtist]])]),(0,r.Lk)("div",x,[t[26]||(t[26]=(0,r.Lk)("label",{for:"character"},"Персонаж:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"character","onUpdate:modelValue":t[7]||(t[7]=e=>s.selectedCharacter=e)},[t[25]||(t[25]=(0,r.Lk)("option",{value:""},"Все",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.characters,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.name,value:e.name},(0,d.v_)(e.name)+" ("+(0,d.v_)(e.count)+") ",9,T)))),128))],512),[[o.u1,s.selectedCharacter]])]),(0,r.Lk)("div",D,[t[28]||(t[28]=(0,r.Lk)("label",{for:"year"},"Год:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"year","onUpdate:modelValue":t[8]||(t[8]=e=>s.selectedYear=e)},[t[27]||(t[27]=(0,r.Lk)("option",{value:""},"Все",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.years,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.name,value:String(e.name)},(0,d.v_)(e.name)+" ("+(0,d.v_)(e.count)+") ",9,O)))),128))],512),[[o.u1,s.selectedYear]])])])]),t[34]||(t[34]=(0,r.Lk)("hr",null,null,-1)),(0,r.Lk)("div",null,[t[32]||(t[32]=(0,r.Lk)("h3",null,"Сортировка:",-1)),(0,r.Lk)("div",U,[(0,r.Lk)("button",{onClick:t[9]||(t[9]=e=>l.toggleSort("year")),class:"sort-button"},[t[30]||(t[30]=(0,r.eW)(" Год ")),(0,r.Lk)("span",{innerHTML:l.yearSortArrow},null,8,V)]),(0,r.Lk)("button",{onClick:t[10]||(t[10]=e=>l.toggleSort("rating")),class:"sort-button"},[t[31]||(t[31]=(0,r.eW)(" Рейтинг ")),(0,r.Lk)("span",{innerHTML:l.ratingSortArrow},null,8,M)]),(0,r.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>l.resetSort&&l.resetSort(...e)),class:"reset-button"},"Сбросить")])]),(0,r.Lk)("div",Q,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.paginatedComics,(e=>((0,r.uX)(),(0,r.Wv)(c,{key:e.id,comic:e},null,8,["comic"])))),128))]),(0,r.Lk)("div",R,[(0,r.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>l.goToPreviousPage&&l.goToPreviousPage(...e)),disabled:1===s.currentPage,class:"button button--accent"}," Предыдущая ",8,j),(0,r.bo)((0,r.Lk)("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=e=>s.currentPageInput=e),onBlur:t[14]||(t[14]=(...e)=>l.goToPageFromInput&&l.goToPageFromInput(...e)),min:"1",max:l.totalPages},null,40,J),[[o.Jo,s.currentPageInput,void 0,{number:!0}]]),(0,r.Lk)("span",null,"/ "+(0,d.v_)(l.totalPages),1),(0,r.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>l.goToNextPage&&l.goToNextPage(...e)),disabled:s.currentPage===l.totalPages,class:"button button--accent"}," Следующая ",8,Y)])])}i(4114),i(8111),i(2489),i(116),i(7588),i(1701),i(8237);const z={class:"comic-card"},W={class:"comic-card__title"},K={class:"comic-card__title-ru"},N=["src","alt"],H={key:0,class:"comic-card__publisher",src:"./images/marvel.png",alt:"Marvel"},q={key:1,class:"comic-card__publisher",src:"./images/dc.png",alt:"DC Comics"},Z={class:"rating-block"},B=["innerHTML"],G=["id"],ee=["href"],te=["src"],ie={class:"button-block"},oe=["href"];function re(e,t,i,o,a,s){const l=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",z,[(0,r.Lk)("h3",W,(0,d.v_)(i.comic.title),1),(0,r.Lk)("h4",K,(0,d.v_)(i.comic.title_ru),1),(0,r.Lk)("img",{class:"comic-card__main-pic",src:i.comic.coverImage,alt:i.comic.title},null,8,N),(0,r.Lk)("p",null,[t[0]||(t[0]=(0,r.Lk)("b",null,"Издательство:",-1)),"Marvel"===i.comic.publisher?((0,r.uX)(),(0,r.CE)("img",H)):"DC Comics"===i.comic.publisher?((0,r.uX)(),(0,r.CE)("img",q)):((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[(0,r.eW)((0,d.v_)(i.comic.publisher),1)],64))]),(0,r.Lk)("div",Z,[(0,r.Lk)("span",null,[t[1]||(t[1]=(0,r.Lk)("b",null,"Рейтинг:",-1)),(0,r.eW)(" "+(0,d.v_)(i.comic.rating)+" из 100",1)]),t[2]||(t[2]=(0,r.Lk)("svg",{width:"32",height:"32",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},[(0,r.Lk)("path",{d:"M31.547 12a.848.848 0 00-.677-.577l-9.427-1.376-4.224-8.532a.847.847 0 00-1.516 0l-4.218 8.534-9.427 1.355a.847.847 0 00-.467 1.467l6.823 6.664-1.612 9.375a.847.847 0 001.23.893l8.428-4.434 8.432 4.432a.847.847 0 001.229-.894l-1.615-9.373 6.822-6.665a.845.845 0 00.214-.869z"})],-1))]),(0,r.Lk)("p",null,[t[3]||(t[3]=(0,r.Lk)("b",null,"Год:",-1)),(0,r.eW)(" "+(0,d.v_)(i.comic.year),1)]),(0,r.Lk)("p",{class:"comic-card__description",innerHTML:i.comic.summary},null,8,B),i.comic.additionalImages&&i.comic.additionalImages.length>0?((0,r.uX)(),(0,r.CE)("div",{key:0,id:a.galleryID,class:"comic-card__gallery"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.comic.additionalImages,((e,t)=>((0,r.uX)(),(0,r.CE)("a",{key:t,href:e,target:"_blank",rel:"noreferrer"},[(0,r.Lk)("img",{src:e,alt:"Доп. фото",style:{"margin-right":"5px"}},null,8,te)],8,ee)))),128))],8,G)):(0,r.Q3)("",!0),(0,r.Lk)("div",ie,[(0,r.bF)(l,{to:{name:"comic-detail",params:{id:i.comic.id}},class:"button button--accent"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)(" Подробнее ")]))),_:1,__:[4]},8,["to"]),(0,r.Lk)("a",{class:"button button--accent",href:i.comic.link,target:"_blank"},"Читать",8,oe)])])}var ae=i(2377),se={name:"ComicCard",props:{comic:{type:Object,required:!0}},data(){return{galleryID:`gallery-${Math.random().toString(36).substring(2,15)}`,lightbox:null}},mounted(){this.comic.additionalImages&&this.comic.additionalImages.length&&(this.lightbox=new ae.A({gallery:"#"+this.galleryID,children:"a",pswpModule:()=>i.e(41).then(i.bind(i,3041)),loop:!0,zoomTitle:"Zoom",zoomEl:!0,wheelToZoom:!0,pinchToClose:!0,closeOnScroll:!1,closeOnVerticalDrag:!0,bgOpacity:1,preventSwiping:!1,showAnimationDuration:0,hideAnimationDuration:0,animateTransitions:!0,closeEl:!0,captionEl:!0,fullscreenEl:!0,shareEl:!0,downloadEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,closeOnOutsideClick:!1,tapToClose:!1,tapToToggleControls:!1}),this.lightbox.init())},unmounted(){this.lightbox&&(this.lightbox.destroy(),this.lightbox=null)},methods:{async getImageSize(e){return new Promise((t=>{const i=new Image;i.onload=()=>{t({w:i.width,h:i.height})},i.onerror=()=>{t({w:0,h:0})},i.src=e}))},async openPhotoSwipe(e=0){const t=await Promise.all((this.comic.additionalImages||[]).map((async e=>{const t=await this.getImageSize(e);return{src:e,w:t.w,h:t.h}})));this.photoSwipeImages=t,this.photoSwipeOptions.index=e,this.lightbox.loadAndOpen(e)}}};const le=(0,n.A)(se,[["render",re],["__scopeId","data-v-5671f344"]]);var ne=le;const ce={class:"random-comics"},ue={class:"filters"},me=["value"],de={class:"comic-list"};function he(e,t,i,a,s,l){const n=(0,r.g2)("comic-card");return(0,r.uX)(),(0,r.CE)("div",ce,[t[5]||(t[5]=(0,r.Lk)("h2",null,"Рандомные комиксы",-1)),(0,r.Lk)("div",ue,[t[4]||(t[4]=(0,r.Lk)("label",{for:"publisher"},"Издательство:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"publisher","onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedPublisher=e),onChange:t[1]||(t[1]=(...e)=>l.updateRandomComics&&l.updateRandomComics(...e))},[t[3]||(t[3]=(0,r.Lk)("option",{value:""},"Все",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.publishers,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.name,value:e.name},(0,d.v_)(e.name)+" ("+(0,d.v_)(e.count)+") ",9,me)))),128))],544),[[o.u1,s.selectedPublisher]]),(0,r.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.updateRandomComics&&l.updateRandomComics(...e))},"Обновить")]),(0,r.Lk)("div",de,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.randomComicsList,(e=>((0,r.uX)(),(0,r.Wv)(n,{key:e.id,comic:e},null,8,["comic"])))),128))])])}i(7642),i(8004),i(3853),i(5876),i(2475),i(5024),i(1698);var pe={name:"RandomComics",components:{ComicCard:ne},props:{comics:{type:Array,required:!0}},data(){return{selectedPublisher:"",randomComicsList:[]}},computed:{publishers(){return this.comics.map((e=>e.publisher)).reduce(((e,t)=>{const i=e.find((e=>e.name===t));return i?i.count++:e.push({name:t,count:1}),e}),[]).sort(((e,t)=>e.name.localeCompare(t.name)))},filteredComics(){return this.selectedPublisher?this.comics.filter((e=>e.publisher===this.selectedPublisher)):this.comics}},methods:{getRandomComics(e,t){const i=e,o=[],r=Math.min(t,i.length);if(0===i.length)return[];const a=new Set;while(a.size<r){const e=Math.floor(Math.random()*i.length);a.add(e)}return a.forEach((e=>{o.push(i[e])})),o},updateRandomComics(){this.randomComicsList=this.getRandomComics(this.filteredComics,4)}},watch:{comics:{handler(){this.updateRandomComics()},deep:!0}}};const ge=(0,n.A)(pe,[["render",he],["__scopeId","data-v-6d167651"]]);var fe=ge,ke=i(4373);const be=8;var ve={name:"ComicList",components:{ComicCard:ne,RandomComics:fe},data(){return{comics:[],currentPage:1,currentPageInput:1,selectedPublisher:"",selectedCharacter:"",selectedYear:"",selectedArtist:"",sortField:null,sortOrder:null,searchQuery:"",searchField:"title",isSearchApplied:!1,isSearchAppliedClass:!1}},mounted(){this.fetchComics()},computed:{totalPages(){return Math.ceil(this.sortedAndFilteredComics.length/be)},paginatedComics(){const e=(this.currentPage-1)*be,t=e+be;return this.sortedAndFilteredComics.slice(e,t)},publishers(){return this.comics.map((e=>e.publisher)).reduce(((e,t)=>{const i=e.find((e=>e.name===t));return i?i.count++:e.push({name:t,count:1}),e}),[]).sort(((e,t)=>e.name.localeCompare(t.name)))},characters(){let e=this.comics;return this.selectedPublisher&&(e=e.filter((e=>e.publisher===this.selectedPublisher))),this.selectedArtist&&(e=e.filter((e=>e.artists&&e.artists.includes(this.selectedArtist)))),e.reduce(((e,t)=>(t.characters.forEach((t=>{const i=e.find((e=>e.name===t));i?i.count++:e.push({name:t,count:1})})),e)),[]).sort(((e,t)=>e.name.localeCompare(t.name)))},years(){let e=this.comics;return this.selectedPublisher&&(e=e.filter((e=>e.publisher===this.selectedPublisher))),this.selectedArtist&&(e=e.filter((e=>e.artists&&e.artists.includes(this.selectedArtist)))),this.selectedCharacter&&(e=e.filter((e=>e.characters&&e.characters.includes(this.selectedCharacter)))),e.map((e=>e.year)).filter((e=>null!=e)).reduce(((e,t)=>{const i=String(t),o=e.find((e=>e.name===i));return o?o.count++:e.push({name:i,count:1}),e}),[]).sort(((e,t)=>e.name.localeCompare(t.name)))},artists(){let e=this.comics;this.selectedPublisher&&(e=e.filter((e=>e.publisher===this.selectedPublisher))),this.selectedCharacter&&(e=e.filter((e=>e.characters&&e.characters.includes(this.selectedCharacter)))),this.selectedYear&&(e=e.filter((e=>String(e.year)===this.selectedYear)));const t=e.reduce(((e,t)=>t.artists&&Array.isArray(t.artists)?e.concat(t.artists):e),[]);return t.filter((e=>null!=e)).reduce(((e,t)=>{const i=String(t),o=e.find((e=>e.name===i));return o?o.count++:e.push({name:i,count:1}),e}),[]).sort(((e,t)=>e.name.localeCompare(t.name)))},filteredComics(){let e=this.comics;if(this.selectedPublisher&&(e=e.filter((e=>e.publisher===this.selectedPublisher))),this.selectedArtist&&(e=e.filter((e=>e.artists&&e.artists.includes(this.selectedArtist)))),this.selectedCharacter&&(e=e.filter((e=>e.characters&&e.characters.includes(this.selectedCharacter)))),this.selectedYear&&(e=e.filter((e=>String(e.year)===this.selectedYear))),this.isSearchApplied&&this.searchQuery.trim()){const t=this.searchQuery.toLowerCase();e=e.filter((e=>{const i=e[this.searchField];return i&&i.toLowerCase().includes(t)})),this.isSearchAppliedClass=!0}return e},sortedAndFilteredComics(){let e=[...this.filteredComics];return this.sortField&&e.sort(((e,t)=>{const i=e[this.sortField],o=t[this.sortField];return i<o?"asc"===this.sortOrder?-1:1:i>o?"asc"===this.sortOrder?1:-1:0})),e},yearSortArrow(){return"year"===this.sortField?"asc"===this.sortOrder?"&#8595;":"&#8593;":""},ratingSortArrow(){return"rating"===this.sortField?"asc"===this.sortOrder?"&#8595;":"&#8593;":""}},watch:{selectedPublisher(e){this.selectedCharacter="",this.selectedYear="",this.selectedArtist=""},selectedArtist(e){this.selectedCharacter="",this.selectedYear=""},searchQuery(e){this.isSearchApplied&&(this.isSearchApplied=!1)}},methods:{async fetchComics(){try{const e=await ke.A.get("http://localhost:3000/comics");this.comics=e.data}catch(e){console.error("Ошибка при загрузке комиксов:",e),console.warn("Вероятнее всего нужно включить JSON сервер: 'json-server --watch db.json --port 3000'")}},goToPreviousPage(){this.currentPage>1&&(this.currentPage--,this.currentPageInput=this.currentPage)},goToNextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.currentPageInput=this.currentPage)},goToPageFromInput(){const e=parseInt(this.currentPageInput);isNaN(e)||e<1?this.currentPage=1:e>this.totalPages?this.currentPage=this.totalPages:this.currentPage=e,this.currentPageInput=this.currentPage},toggleSort(e){this.sortField===e?null===this.sortOrder?this.sortOrder="desc":"desc"===this.sortOrder?this.sortOrder="asc":(this.sortOrder=null,this.sortField=null):(this.sortField=e,this.sortOrder="desc"),this.currentPage=1,this.currentPageInput=1},resetSort(){this.sortField=null,this.sortOrder=null,this.currentPage=1,this.currentPageInput=1},applySearch(){this.currentPage=1,this.currentPageInput=1,this.isSearchApplied=!0}}};const ye=(0,n.A)(ve,[["render",$],["__scopeId","data-v-01f3712b"]]);var Le=ye;const Ce={class:"comic-detail"},_e={key:0},Ee={key:0},we={class:"comic-info"},Ie=["src","alt"],Ae={class:"comic-details"},Pe={key:0},Se={key:1},Fe={key:2},Xe={key:3},xe={key:4},Te={key:5},De={key:6},Oe={key:7},Ue={key:8},Ve=["innerHTML"],Me={key:9},Qe={key:10},Re=["href"],je={key:11,class:"additional-images"},Je=["id"],Ye=["href"],$e=["src"],ze={key:1};function We(e,t,i,o,a,s){const l=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Ce,[(0,r.bF)(l,{to:"/"},{default:(0,r.k6)((()=>t[1]||(t[1]=[(0,r.eW)(" ← Назад к списку ")]))),_:1,__:[1]}),a.comic?((0,r.uX)(),(0,r.CE)("div",_e,[(0,r.Lk)("h2",null,(0,d.v_)(a.comic.title),1),a.comic.title_ru?((0,r.uX)(),(0,r.CE)("p",Ee,"**Название (рус):** "+(0,d.v_)(a.comic.title_ru),1)):(0,r.Q3)("",!0),(0,r.Lk)("div",we,[(0,r.Lk)("img",{class:"comic-info__main-pic",src:a.comic.coverImage,alt:a.comic.title,width:"200"},null,8,Ie),(0,r.Lk)("div",Ae,[(0,r.Lk)("p",null,"Издательство: "+(0,d.v_)(a.comic.publisher),1),(0,r.Lk)("p",null,"Год: "+(0,d.v_)(a.comic.year),1),(0,r.Lk)("p",null,"Жанр: "+(0,d.v_)(a.comic.genre),1),(0,r.Lk)("p",null,"Статус: "+(0,d.v_)(a.comic.status),1),(0,r.Lk)("p",null,"Рейтинг: "+(0,d.v_)(a.comic.rating)+" / 100",1),(0,r.Lk)("p",null,"Рейтинг рисовки: "+(0,d.v_)(a.comic.artRating)+" / 100",1),a.comic.startDate?((0,r.uX)(),(0,r.CE)("p",Pe,"Дата начала: "+(0,d.v_)(s.formatDate(a.comic.startDate)),1)):(0,r.Q3)("",!0),a.comic.endDate?((0,r.uX)(),(0,r.CE)("p",Se,"Дата завершения: "+(0,d.v_)(s.formatDate(a.comic.endDate)),1)):(0,r.Q3)("",!0),a.comic.volume?((0,r.uX)(),(0,r.CE)("p",Fe,"Том: "+(0,d.v_)(a.comic.volume),1)):(0,r.Q3)("",!0),a.comic.issues?((0,r.uX)(),(0,r.CE)("p",Xe,"Выпусков: "+(0,d.v_)(a.comic.issues),1)):(0,r.Q3)("",!0),a.comic.readTo?((0,r.uX)(),(0,r.CE)("p",xe,"Прочитано до: "+(0,d.v_)(a.comic.readTo),1)):(0,r.Q3)("",!0),a.comic.event?((0,r.uX)(),(0,r.CE)("p",Te,"Событие: "+(0,d.v_)(a.comic.event),1)):(0,r.Q3)("",!0),a.comic.characters&&a.comic.characters.length>0?((0,r.uX)(),(0,r.CE)("p",De,"Персонажи: "+(0,d.v_)(a.comic.characters.join(", ")),1)):(0,r.Q3)("",!0),a.comic.artists&&a.comic.artists.length>0?((0,r.uX)(),(0,r.CE)("p",Oe,"Художники: "+(0,d.v_)(a.comic.artists.join(", ")),1)):(0,r.Q3)("",!0),a.comic.summary?((0,r.uX)(),(0,r.CE)("div",Ue,[(0,r.Lk)("p",{innerHTML:a.comic.summary},null,8,Ve)])):(0,r.Q3)("",!0),a.comic.notes?((0,r.uX)(),(0,r.CE)("p",Me,"Заметки: "+(0,d.v_)(a.comic.notes),1)):(0,r.Q3)("",!0),a.comic.link?((0,r.uX)(),(0,r.CE)("p",Qe,[(0,r.Lk)("a",{href:a.comic.link,target:"_blank"},"Читать комикс",8,Re)])):(0,r.Q3)("",!0),a.comic.additionalImages&&a.comic.additionalImages.length>0?((0,r.uX)(),(0,r.CE)("div",je,[t[2]||(t[2]=(0,r.Lk)("h4",null,"Дополнительные изображения:",-1)),a.comic.additionalImages.length>0?((0,r.uX)(),(0,r.CE)("div",{key:0,id:a.galleryID,class:"comic-card__gallery"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.comic.additionalImages,((e,t)=>((0,r.uX)(),(0,r.CE)("a",{key:t,href:e,target:"_blank",rel:"noreferrer"},[(0,r.Lk)("img",{src:e,alt:"Доп. фото",width:"100",style:{"margin-right":"5px",cursor:"pointer"}},null,8,$e)],8,Ye)))),128))],8,Je)):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.editComic&&s.editComic(...e))},"Редактировать")])):((0,r.uX)(),(0,r.CE)("p",ze,"Загрузка..."))])}var Ke=i(9740),Ne={name:"ComicDetail",data(){return{comic:null,galleryID:`gallery-${Math.random().toString(36).substring(2,15)}`,lightbox:null}},mounted(){this.fetchComic()},beforeUnmount(){this.lightbox&&(this.lightbox.destroy(),this.lightbox=null)},methods:{async getImageSize(e){return new Promise((t=>{const i=new Image;i.onload=()=>{t({w:i.width,h:i.height})},i.onerror=()=>{t({w:800,h:600})},i.src=e}))},async handleAdditionalImagesChange(e){const t=e.target.files;if(t&&t.length>0){this.form.additionalImages=[];for(let e=0;e<t.length;e++){const i=new FileReader;i.onload=e=>{this.form.additionalImages.push(e.target.result)},i.readAsDataURL(t[e])}await this.$nextTick(),this.lightbox&&this.lightbox.destroy(),this.lightbox=new ae.A({gallery:"#"+this.galleryID,children:"a",pswpModule:()=>i.e(41).then(i.bind(i,3041)),loop:!0,zoomEl:!0,pinchToClose:!0,closeOnScroll:!1,captionEl:!0,counterEl:!0}),this.lightbox.init()}},async fetchComic(){try{const e=this.$route.params.id,t=await ke.A.get(`http://localhost:3000/comics/${e}`);this.comic=t.data,await this.$nextTick(),this.comic.additionalImages.length>0&&(console.log("PhotoSwipeLightbox"),this.lightbox=new ae.A({gallery:"#"+this.galleryID,children:"a",pswpModule:()=>i.e(41).then(i.bind(i,3041)),loop:!0,zoomTitle:"Zoom",zoomEl:!0,wheelToZoom:!0,pinchToClose:!0,closeOnScroll:!1,closeOnVerticalDrag:!0,bgOpacity:1,preventSwiping:!1,showAnimationDuration:0,hideAnimationDuration:0,animateTransitions:!0,closeEl:!0,captionEl:!0,fullscreenEl:!0,shareEl:!0,downloadEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,closeOnOutsideClick:!1,tapToClose:!1,tapToToggleControls:!1}),this.lightbox.init())}catch(e){console.error("Ошибка при загрузке комикса:",e),this.$router.push("/")}},editComic(){this.$router.push({name:"edit-comic",params:{id:this.comic.id}})},formatDate(e){if(!e)return"";try{const t=new Date(e);return(0,Ke.GP)(t,"yyyy-MM-dd")}catch(t){return console.error("Ошибка при форматировании даты:",t),e}}}};const He=(0,n.A)(Ne,[["render",We],["__scopeId","data-v-5a7bac6d"]]);var qe=He;const Ze={class:"comic-form"},Be={class:"form-group"},Ge={class:"form-group"},et={class:"form-group"},tt={class:"form-group"},it={class:"form-group"},ot={class:"form-group"},rt={class:"form-group"},at={class:"form-group"},st={class:"form-group"},lt={class:"form-group"},nt={class:"form-group"},ct={class:"form-group"},ut={class:"form-group"},mt={class:"form-group"},dt={class:"form-group"},ht={class:"form-group"},pt={class:"form-group"},gt={class:"form-group"},ft=["src"],kt={class:"form-group"},bt=["id"],vt=["href"],yt=["src"],Lt={class:"form-group"},Ct={class:"form-group"};function _t(e,t,i,a,s,l){return(0,r.uX)(),(0,r.CE)("div",Ze,[(0,r.Lk)("h2",null,(0,d.v_)(i.comic?"Редактировать комикс":"Добавить комикс"),1),(0,r.Lk)("form",{onSubmit:t[24]||(t[24]=(0,o.D$)(((...e)=>l.onSubmit&&l.onSubmit(...e)),["prevent"]))},[(0,r.Lk)("div",Be,[t[25]||(t[25]=(0,r.Lk)("label",{for:"title"},"Название:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>s.form.title=e),required:""},null,512),[[o.Jo,s.form.title]])]),(0,r.Lk)("div",null,[t[26]||(t[26]=(0,r.Lk)("label",{for:"title_ru"},"Название (рус):",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"title_ru","onUpdate:modelValue":t[1]||(t[1]=e=>s.form.title_ru=e)},null,512),[[o.Jo,s.form.title_ru]])]),(0,r.Lk)("div",Ge,[t[27]||(t[27]=(0,r.Lk)("label",{for:"publisher"},"Издательство:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"publisher","onUpdate:modelValue":t[2]||(t[2]=e=>s.form.publisher=e),required:""},null,512),[[o.Jo,s.form.publisher]])]),(0,r.Lk)("div",et,[t[28]||(t[28]=(0,r.Lk)("label",{for:"characters"},"Персонажи (через запятую):",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"characters","onUpdate:modelValue":t[3]||(t[3]=e=>s.form.charactersString=e),onBlur:t[4]||(t[4]=(...e)=>l.splitCharacters&&l.splitCharacters(...e))},null,544),[[o.Jo,s.form.charactersString]])]),(0,r.Lk)("div",tt,[t[29]||(t[29]=(0,r.Lk)("label",{for:"year"},"Год:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"year","onUpdate:modelValue":t[5]||(t[5]=e=>s.form.year=e)},null,512),[[o.Jo,s.form.year,void 0,{number:!0}]])]),(0,r.Lk)("div",it,[t[30]||(t[30]=(0,r.Lk)("label",{for:"startDate"},"Дата начала:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"startDate","onUpdate:modelValue":t[6]||(t[6]=e=>s.form.startDate=e)},null,512),[[o.Jo,s.form.startDate]])]),(0,r.Lk)("div",ot,[t[31]||(t[31]=(0,r.Lk)("label",{for:"endDate"},"Дата завершения:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"endDate","onUpdate:modelValue":t[7]||(t[7]=e=>s.form.endDate=e)},null,512),[[o.Jo,s.form.endDate]])]),(0,r.Lk)("div",rt,[t[32]||(t[32]=(0,r.Lk)("label",{for:"volume"},"Том:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"volume","onUpdate:modelValue":t[8]||(t[8]=e=>s.form.volume=e)},null,512),[[o.Jo,s.form.volume,void 0,{number:!0}]])]),(0,r.Lk)("div",at,[t[33]||(t[33]=(0,r.Lk)("label",{for:"issues"},"Выпуски:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"issues","onUpdate:modelValue":t[9]||(t[9]=e=>s.form.issues=e)},null,512),[[o.Jo,s.form.issues,void 0,{number:!0}]])]),(0,r.Lk)("div",st,[t[34]||(t[34]=(0,r.Lk)("label",{for:"readTo"},"Прочитано до выпуска:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"readTo","onUpdate:modelValue":t[10]||(t[10]=e=>s.form.readTo=e)},null,512),[[o.Jo,s.form.readTo,void 0,{number:!0}]])]),(0,r.Lk)("div",lt,[t[35]||(t[35]=(0,r.Lk)("label",{for:"genre"},"Жанр:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"genre","onUpdate:modelValue":t[11]||(t[11]=e=>s.form.genre=e)},null,512),[[o.Jo,s.form.genre]])]),(0,r.Lk)("div",nt,[t[36]||(t[36]=(0,r.Lk)("label",{for:"event"},"Событие:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"event","onUpdate:modelValue":t[12]||(t[12]=e=>s.form.event=e)},null,512),[[o.Jo,s.form.event]])]),(0,r.Lk)("div",ct,[t[38]||(t[38]=(0,r.Lk)("label",{for:"status"},"Статус:",-1)),(0,r.bo)((0,r.Lk)("select",{id:"status","onUpdate:modelValue":t[13]||(t[13]=e=>s.form.status=e)},t[37]||(t[37]=[(0,r.Lk)("option",{value:"продолжается"},"Продолжается",-1),(0,r.Lk)("option",{value:"закончен"},"Закончен",-1)]),512),[[o.u1,s.form.status]])]),(0,r.Lk)("div",ut,[t[39]||(t[39]=(0,r.Lk)("label",{for:"artists"},"Художники (через запятую):",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"artists","onUpdate:modelValue":t[14]||(t[14]=e=>s.form.artistsString=e),onBlur:t[15]||(t[15]=(...e)=>l.splitArtists&&l.splitArtists(...e))},null,544),[[o.Jo,s.form.artistsString]])]),(0,r.Lk)("div",mt,[t[40]||(t[40]=(0,r.Lk)("label",{for:"summary"},"Краткое описание:",-1)),(0,r.bo)((0,r.Lk)("textarea",{id:"summary","onUpdate:modelValue":t[16]||(t[16]=e=>s.form.summary=e)},null,512),[[o.Jo,s.form.summary]])]),(0,r.Lk)("div",dt,[t[41]||(t[41]=(0,r.Lk)("label",{for:"notes"},"Заметки:",-1)),(0,r.bo)((0,r.Lk)("textarea",{id:"notes","onUpdate:modelValue":t[17]||(t[17]=e=>s.form.notes=e)},null,512),[[o.Jo,s.form.notes]])]),(0,r.Lk)("div",ht,[t[42]||(t[42]=(0,r.Lk)("label",{for:"rating"},"Рейтинг (1-100):",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"rating","onUpdate:modelValue":t[18]||(t[18]=e=>s.form.rating=e),min:"1",max:"100"},null,512),[[o.Jo,s.form.rating,void 0,{number:!0}]])]),(0,r.Lk)("div",pt,[t[43]||(t[43]=(0,r.Lk)("label",{for:"artRating"},"Рейтинг рисовки (1-100):",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"artRating","onUpdate:modelValue":t[19]||(t[19]=e=>s.form.artRating=e),min:"1",max:"100"},null,512),[[o.Jo,s.form.artRating,void 0,{number:!0}]])]),(0,r.Lk)("div",gt,[t[44]||(t[44]=(0,r.Lk)("label",{for:"coverImage"},"Главное фото:",-1)),(0,r.Lk)("input",{type:"file",id:"coverImage",onChange:t[20]||(t[20]=(...e)=>l.handleCoverImageChange&&l.handleCoverImageChange(...e))},null,32),s.form.coverImage?((0,r.uX)(),(0,r.CE)("img",{key:0,src:s.form.coverImage,alt:"Обложка",width:"100"},null,8,ft)):(0,r.Q3)("",!0)]),(0,r.Lk)("div",kt,[t[45]||(t[45]=(0,r.Lk)("label",{for:"additionalImages"},"Дополнительные фото:",-1)),(0,r.Lk)("input",{type:"file",id:"additionalImages",multiple:"",onChange:t[21]||(t[21]=(...e)=>l.handleAdditionalImagesChange&&l.handleAdditionalImagesChange(...e))},null,32),s.form.additionalImages.length>0?((0,r.uX)(),(0,r.CE)("div",{key:0,id:s.galleryID,class:"comic-card__gallery"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.form.additionalImages,((e,t)=>((0,r.uX)(),(0,r.CE)("a",{key:t,href:e,target:"_blank",rel:"noreferrer"},[(0,r.Lk)("img",{src:e,alt:"Доп. фото",width:"100",style:{"margin-right":"5px",cursor:"pointer"}},null,8,yt)],8,vt)))),128))],8,bt)):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Lt,[t[46]||(t[46]=(0,r.Lk)("label",{for:"link"},"Ссылка:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"link","onUpdate:modelValue":t[22]||(t[22]=e=>s.form.link=e)},null,512),[[o.Jo,s.form.link]])]),(0,r.Lk)("div",Ct,[t[47]||(t[47]=(0,r.Lk)("label",{for:"isFavorite"},"Интересное:",-1)),(0,r.bo)((0,r.Lk)("input",{type:"checkbox",id:"isFavorite","onUpdate:modelValue":t[23]||(t[23]=e=>s.form.isFavorite=e)},null,512),[[o.lH,s.form.isFavorite]])]),t[48]||(t[48]=(0,r.Lk)("button",{type:"submit"},"Сохранить",-1))],32)])}var Et={name:"ComicForm",props:{comic:{type:Object,default:null}},data(){return{form:{title:this.comic?this.comic.title:"",title_ru:this.comic?this.comic.title_ru:"",publisher:this.comic?this.comic.publisher:"",characters:this.comic?[...this.comic.characters]:[],year:this.comic?this.comic.year:null,startDate:this.comic?this.comic.startDate:null,endDate:this.comic?this.comic.endDate:null,volume:this.comic?this.comic.volume:null,issues:this.comic?this.comic.issues:null,readTo:this.comic?this.comic.readTo:null,genre:this.comic?this.comic.genre:"",event:this.comic?this.comic.event:"",status:this.comic?this.comic.status:"продолжается",artists:this.comic?[...this.comic.artists]:[],summary:this.comic?this.comic.summary:"",notes:this.comic?this.comic.notes:"",rating:this.comic?this.comic.rating:null,artRating:this.comic?this.comic.artRating:null,coverImage:this.comic?this.comic.coverImage:"",additionalImages:this.comic?[...this.comic.additionalImages]:[],link:this.comic?this.comic.link:"",isFavorite:!!this.comic&&this.comic.isFavorite},galleryID:`gallery-${Math.random().toString(36).substring(2,15)}`,lightbox:null}},computed:{formCharacters:{get(){return this.form.characters.join(", ")},set(e){this.form.characters=e.split(",").map((e=>e.trim()))}},formArtists:{get(){return this.form.artists.join(", ")},set(e){this.form.artists=e.split(",").map((e=>e.trim()))}}},mounted(){this.form.additionalImages.length>0&&(this.lightbox=new ae.A({gallery:"#"+this.galleryID,children:"a",pswpModule:()=>i.e(41).then(i.bind(i,3041)),loop:!0,zoomTitle:"Zoom",zoomEl:!0,wheelToZoom:!0,pinchToClose:!0,closeOnScroll:!1,closeOnVerticalDrag:!0,bgOpacity:1,preventSwiping:!1,showAnimationDuration:0,hideAnimationDuration:0,animateTransitions:!0,closeEl:!0,captionEl:!0,fullscreenEl:!0,shareEl:!0,downloadEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,closeOnOutsideClick:!1,tapToClose:!1,tapToToggleControls:!1}),this.lightbox.init())},beforeUnmount(){this.lightbox&&(this.lightbox.destroy(),this.lightbox=null)},methods:{async getImageSize(e){return new Promise((t=>{const i=new Image;i.onload=()=>{t({w:i.width,h:i.height})},i.onerror=()=>{t({w:800,h:600})},i.src=e}))},async handleAdditionalImagesChange(e){const t=e.target.files;if(t&&t.length>0){this.form.additionalImages=[];for(let e=0;e<t.length;e++){const i=new FileReader;i.onload=e=>{this.form.additionalImages.push(e.target.result)},i.readAsDataURL(t[e])}await this.$nextTick(),this.lightbox&&this.lightbox.destroy(),this.lightbox=new ae.A({gallery:"#"+this.galleryID,children:"a",pswpModule:()=>i.e(41).then(i.bind(i,3041)),loop:!0,zoomEl:!0,pinchToClose:!0,closeOnScroll:!1,captionEl:!0,counterEl:!0}),this.lightbox.init()}},formMainImg(e){function t(e){if("string"!==typeof e)return console.error("Input must be a string."),"";const t={"а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"shh","ъ":"0","ы":"y","ь":"0","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Shh","Ъ":"0","Ы":"Y","Ь":"0","Э":"E","Ю":"Yu","Я":"Ya"};let i="";for(let o=0;o<e.length;o++){const r=e[o];i+=t[r]||r}return i=i.replace(/[\s.,;:'"“”‘’«»(){}\[\]!&?#№]/g,"-"),i=i.replace(/-+/g,"-"),i=i.replace(/^-+|-+$/g,""),i.toLowerCase()}return t(e)},async onSubmit(){if(this.validateForm())try{if(this.comic)await ke.A.put(`http://localhost:3000/comics/${this.comic.id}`,this.form),this.$emit("comic-updated");else{if(this.form.title){this.form.coverImage="./images/"+this.formMainImg(this.form.title)+"/001.jpg",this.form.additionalImages=[];for(let e=1;e<=6;e++)this.form.additionalImages.push("./images/"+this.formMainImg(this.form.title)+`/00${e}.jpg`)}const e=await ke.A.post("http://localhost:3000/comics",this.form),t=e.data;console.log("Комикс добавлен с ID:",t.id),this.$router.push({name:"comic-detail",params:{id:t.id}})}}catch(e){console.error("Ошибка при сохранении комикса:",e)}},validateForm(){return this.form.title&&this.form.publisher&&this.form.year?this.form.year&&(this.form.year<1900||this.form.year>(new Date).getFullYear())?(alert("Некорректный год"),!1):this.form.rating&&(this.form.rating<1||this.form.rating>100)?(alert("Рейтинг должен быть от 1 до 100"),!1):!this.form.artRating||!(this.form.artRating<1||this.form.artRating>100)||(alert("Рейтинг рисовки должен быть от 1 до 100"),!1):(alert("Пожалуйста, заполните обязательные поля: Название, Издательство, Год"),!1)},splitCharacters(){this.form.characters=this.formCharacters.split(",").map((e=>e.trim()))},splitArtists(){this.form.artists=this.formArtists.split(",").map((e=>e.trim()))},handleCoverImageChange(e){const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{this.form.coverImage=e.target.result},e.readAsDataURL(t)}},handleAdditionalImagesChange(e){const t=e.target.files;if(t){this.form.additionalImages=[];for(let e=0;e<t.length;e++){const i=new FileReader;i.onload=e=>{this.form.additionalImages.push(e.target.result)},i.readAsDataURL(t[e])}}}}};const wt=(0,n.A)(Et,[["render",_t],["__scopeId","data-v-1ab7b9c7"]]);var It=wt;const At={class:"comic-edit"},Pt={key:0},St={key:1};function Ft(e,t,i,o,a,s){const l=(0,r.g2)("router-link"),n=(0,r.g2)("comic-form");return(0,r.uX)(),(0,r.CE)("div",At,[(0,r.bF)(l,{to:{name:"comic-detail",params:{id:i.id}}},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.eW)(" ← Назад к деталям ")]))),_:1,__:[0]},8,["to"]),t[1]||(t[1]=(0,r.Lk)("h2",null,"Редактировать комикс",-1)),a.comic?((0,r.uX)(),(0,r.CE)("div",Pt,[(0,r.bF)(n,{comic:a.comic,onComicUpdated:s.onComicUpdated},null,8,["comic","onComicUpdated"])])):((0,r.uX)(),(0,r.CE)("p",St,"Загрузка..."))])}var Xt={name:"ComicEdit",components:{ComicForm:It},props:{id:{type:Number,required:!0}},data(){return{comic:null}},mounted(){this.fetchComic()},methods:{async fetchComic(){try{const e=await ke.A.get(`http://localhost:3000/comics/${this.id}`);this.comic=e.data}catch(e){console.error("Ошибка при загрузке комикса:",e),this.$router.push("/")}},onComicUpdated(){this.$router.push({name:"comic-detail",params:{id:this.id}})}}};const xt=(0,n.A)(Xt,[["render",Ft],["__scopeId","data-v-6c6e26d3"]]);var Tt=xt;const Dt=(0,m.aE)({history:(0,m.LA)("/"),routes:[{path:"/",name:"home",component:Le},{path:"/comic/:id",name:"comic-detail",component:qe},{path:"/add",name:"add-comic",component:It},{path:"/comic/:id/edit",name:"edit-comic",component:Tt,props:!0}]});var Ot=Dt,Ut=i(782),Vt=(0,Ut.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,o.Ef)(u).use(Vt).use(Ot).mount("#app")}},t={};function i(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,o,r,a){if(!o){var s=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],a=e[u][2];for(var l=!0,n=0;n<o.length;n++)(!1&a||s>=a)&&Object.keys(i.O).every((function(e){return i.O[e](o[n])}))?o.splice(n--,1):(l=!1,a<s&&(s=a));if(l){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,r,a]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,o){return i.f[o](e,t),t}),[]))}}(),function(){i.u=function(e){return"js/"+e+".3ab13d2b.js"}}(),function(){i.miniCssF=function(e){}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="comic-catalog-work:";i.l=function(o,r,a,s){if(e[o])e[o].push(r);else{var l,n;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var m=c[u];if(m.getAttribute("src")==o||m.getAttribute("data-webpack")==t+a){l=m;break}}l||(n=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.setAttribute("data-webpack",t+a),l.src=o),e[o]=[r];var d=function(t,i){l.onerror=l.onload=null,clearTimeout(h);var r=e[o];if(delete e[o],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((function(e){return e(i)})),t)return t(i)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=d.bind(null,l.onerror),l.onload=d.bind(null,l.onload),n&&document.head.appendChild(l)}}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p="/"}(),function(){var e={524:0};i.f.j=function(t,o){var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var a=new Promise((function(i,o){r=e[t]=[i,o]}));o.push(r[2]=a);var s=i.p+i.u(t),l=new Error,n=function(o){if(i.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var a=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;l.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",l.name="ChunkLoadError",l.type=a,l.request=s,r[1](l)}};i.l(s,n,"chunk-"+t,t)}},i.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,s=o[0],l=o[1],n=o[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(r in l)i.o(l,r)&&(i.m[r]=l[r]);if(n)var u=n(i)}for(t&&t(o);c<s.length;c++)a=s[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},o=self["webpackChunkcomic_catalog_work"]=self["webpackChunkcomic_catalog_work"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[504],(function(){return i(3740)}));o=i.O(o)})();
//# sourceMappingURL=app.4fe528a2.js.map